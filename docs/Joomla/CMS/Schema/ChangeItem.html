

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="ru" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="ru" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Joomla\CMS\Schema\ChangeItem &mdash; документация joomla-docs-rus 3.9.16</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/language_data.js"></script>
        <script src="../../../_static/translations.js"></script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Алфавитный указатель" href="../../../genindex.html" />
    <link rel="search" title="Поиск" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: white" >
          

          
            <a href="../../../index.html" class="icon icon-home"> joomla-docs-rus
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <!-- Local TOC -->
              <div class="local-toc"><ul>
<li><a class="reference internal" href="#">Joomla\CMS\Schema\ChangeItem</a></li>
</ul>
</div>
            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">joomla-docs-rus</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content style-external-links">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html">Docs</a> &raquo;</li>
        
      <li>Joomla\CMS\Schema\ChangeItem</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../../_sources/Joomla/CMS/Schema/ChangeItem.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="joomla-cms-schema-changeitem">
<h1>Joomla\CMS\Schema\ChangeItem<a class="headerlink" href="#joomla-cms-schema-changeitem" title="Ссылка на этот заголовок">¶</a></h1>
<dl class="class">
<dt id="ChangeItem">
<em class="property">class </em><code class="sig-name descname">ChangeItem</code><a class="headerlink" href="#ChangeItem" title="Ссылка на это определение">¶</a></dt>
<dd><p>Each object represents one query, which is one line from a DDL SQL query.
This class is used to check the site’s database to see if the DDL query has been run.
If not, it provides the ability to fix the database by re-running the DDL query.
The queries are parsed from the update files in the folder
<cite>administrator/components/com_admin/sql/updates/&lt;database&gt;</cite>.
These updates are run automatically if the site was updated using com_installer.
However, it is possible that the program files could be updated without udpating
the database (for example, if a user just copies the new files over the top of an
existing installation).</p>
<p>This is an abstract class. We need to extend it for each database and add a buildCheckQuery() method that creates the query to check that a DDL query has been run.</p>
<dl class="attr">
<dt id="ChangeItem::$file">
<em class="property">property </em><code class="sig-name descname">file</code><a class="headerlink" href="#ChangeItem::$file" title="Ссылка на это определение">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>string</p>
</dd>
</dl>
<p>Update file: full path file name where query was found</p>
</dd></dl>

<dl class="attr">
<dt id="ChangeItem::$updateQuery">
<em class="property">property </em><code class="sig-name descname">updateQuery</code><a class="headerlink" href="#ChangeItem::$updateQuery" title="Ссылка на это определение">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>string</p>
</dd>
</dl>
<p>Update query: query used to change the db schema (one line from the file)</p>
</dd></dl>

<dl class="attr">
<dt id="ChangeItem::$checkQuery">
<em class="property">property </em><code class="sig-name descname">checkQuery</code><a class="headerlink" href="#ChangeItem::$checkQuery" title="Ссылка на это определение">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>string</p>
</dd>
</dl>
<p>Check query: query used to check the db schema</p>
</dd></dl>

<dl class="attr">
<dt id="ChangeItem::$checkQueryExpected">
<em class="property">property </em><code class="sig-name descname">checkQueryExpected</code><a class="headerlink" href="#ChangeItem::$checkQueryExpected" title="Ссылка на это определение">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>string</p>
</dd>
</dl>
<p>Check query result: expected result of check query if database is up to
date</p>
</dd></dl>

<dl class="attr">
<dt id="ChangeItem::$db">
<em class="property">property </em><code class="sig-name descname">db</code><a class="headerlink" href="#ChangeItem::$db" title="Ссылка на это определение">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>JDatabaseDriver</p>
</dd>
</dl>
<p>JDatabaseDriver object</p>
</dd></dl>

<dl class="attr">
<dt id="ChangeItem::$queryType">
<em class="property">property </em><code class="sig-name descname">queryType</code><a class="headerlink" href="#ChangeItem::$queryType" title="Ссылка на это определение">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>string</p>
</dd>
</dl>
<p>Query type: To be used in building a language key for a
message to tell user what was checked / changed
Possible values: ADD_TABLE, ADD_COLUMN, CHANGE_COLUMN_TYPE, ADD_INDEX</p>
</dd></dl>

<dl class="attr">
<dt id="ChangeItem::$msgElements">
<em class="property">property </em><code class="sig-name descname">msgElements</code><a class="headerlink" href="#ChangeItem::$msgElements" title="Ссылка на это определение">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
<p>Array with values for use in a JText::sprintf statment indicating what
was checked</p>
<p>Tells you what the message should be, based on which elements are defined,
as follows:
For ADD_TABLE: table For ADD_COLUMN: table, column For CHANGE_COLUMN_TYPE:
table, column, type For ADD_INDEX: table, index</p>
</dd></dl>

<dl class="attr">
<dt id="ChangeItem::$checkStatus">
<em class="property">property </em><code class="sig-name descname">checkStatus</code><a class="headerlink" href="#ChangeItem::$checkStatus" title="Ссылка на это определение">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>integer</p>
</dd>
</dl>
<p>Checked status</p>
</dd></dl>

<dl class="attr">
<dt id="ChangeItem::$rerunStatus">
<em class="property">property </em><code class="sig-name descname">rerunStatus</code><a class="headerlink" href="#ChangeItem::$rerunStatus" title="Ссылка на это определение">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
<p>Rerun status</p>
</dd></dl>

<dl class="method">
<dt id="ChangeItem::__construct">
<code class="sig-name descname">__construct</code><span class="sig-paren">(</span><em class="sig-param">$db</em>, <em class="sig-param">$file</em>, <em class="sig-param">$query</em><span class="sig-paren">)</span><a class="headerlink" href="#ChangeItem::__construct" title="Ссылка на это определение">¶</a></dt>
<dd><p>Constructor: builds check query and message from $updateQuery</p>
<dl class="field-list simple">
<dt class="field-odd">Параметры</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>$db</strong> – </p></li>
<li><p><strong>$file</strong> – </p></li>
<li><p><strong>$query</strong> – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="ChangeItem::getInstance">
<code class="sig-name descname">getInstance</code><span class="sig-paren">(</span><em class="sig-param">$db</em>, <em class="sig-param">$file</em>, <em class="sig-param">$query</em><span class="sig-paren">)</span><a class="headerlink" href="#ChangeItem::getInstance" title="Ссылка на это определение">¶</a></dt>
<dd><p>Returns a reference to the ChangeItem object.</p>
<dl class="field-list simple">
<dt class="field-odd">Параметры</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>$db</strong> – </p></li>
<li><p><strong>$file</strong> – </p></li>
<li><p><strong>$query</strong> – </p></li>
</ul>
</dd>
<dt class="field-even">Результат</dt>
<dd class="field-even"><p>ChangeItem instance based on the database driver</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="ChangeItem::buildCheckQuery">
<code class="sig-name descname">buildCheckQuery</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ChangeItem::buildCheckQuery" title="Ссылка на это определение">¶</a></dt>
<dd><p>Checks a DDL query to see if it is a known type
If yes, build a check query to see if the DDL has been run on the
database.
If successful, the $msgElements, $queryType, $checkStatus and $checkQuery
fields are populated.
The $msgElements contains the text to create the user message.
The $checkQuery contains the SQL query to check whether the schema change
has
been run against the current database. The $queryType contains the type of
DDL query that was run (for example, CREATE_TABLE, ADD_COLUMN,
CHANGE_COLUMN_TYPE, ADD_INDEX).
The $checkStatus field is set to zero if the query is created</p>
<p>If not successful, $checkQuery is empty and , and $checkStatus is -1.
For example, this will happen if the current line is a non-DDL statement.</p>
<dl class="field-list simple">
<dt class="field-odd">Результат</dt>
<dd class="field-odd"><p>void</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="ChangeItem::check">
<code class="sig-name descname">check</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ChangeItem::check" title="Ссылка на это определение">¶</a></dt>
<dd><p>Runs the check query and checks that 1 row is returned
If yes, return true, otherwise return false</p>
<dl class="field-list simple">
<dt class="field-odd">Результат</dt>
<dd class="field-odd"><p>boolean true on success, false otherwise</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="ChangeItem::fix">
<code class="sig-name descname">fix</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ChangeItem::fix" title="Ссылка на это определение">¶</a></dt>
<dd><p>Runs the update query to apply the change to the database</p>
<dl class="field-list simple">
<dt class="field-odd">Результат</dt>
<dd class="field-odd"><p>void</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Artem Vasilev &lt;kern.usr@gmail.com&gt;

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>